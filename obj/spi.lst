   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.eabi_attribute 27, 3
   4              		.fpu fpv4-sp-d16
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 6
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.thumb
  15              		.file	"spi.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.comm	bufferTX,2000,4
  20              		.comm	bufferRX,2000,4
  21              		.comm	bufferRXidx,4,4
  22              		.comm	bufferTXidx,4,4
  23              		.comm	dat_lengthRX,4,4
  24              		.comm	dat_lengthTX,4,4
  25              		.section	.bss.xSemaphoreDMASPIx,"aw",%nobits
  26              		.align	2
  29              	xSemaphoreDMASPIx:
  30 0000 00000000 		.space	4
  31              		.section	.bss.xSemaphoreDMASPIy,"aw",%nobits
  32              		.align	2
  35              	xSemaphoreDMASPIy:
  36 0000 00000000 		.space	4
  37              		.section	.text.init_SPIx,"ax",%progbits
  38              		.align	2
  39              		.global	init_SPIx
  40              		.thumb
  41              		.thumb_func
  43              	init_SPIx:
  44              	.LFB110:
  45              		.file 1 "App/STM32F4-Discovery/spi.c"
   1:App/STM32F4-Discovery/spi.c **** /*! \file spi.c */ 
   2:App/STM32F4-Discovery/spi.c **** 
   3:App/STM32F4-Discovery/spi.c **** #include "spi.h"
   4:App/STM32F4-Discovery/spi.c **** #define pdFalse 0
   5:App/STM32F4-Discovery/spi.c **** #define pdTrue 	1
   6:App/STM32F4-Discovery/spi.c **** 
   7:App/STM32F4-Discovery/spi.c **** static xSemaphoreHandle xSemaphoreDMASPIx;
   8:App/STM32F4-Discovery/spi.c **** static xSemaphoreHandle xSemaphoreDMASPIy;
   9:App/STM32F4-Discovery/spi.c **** 
  10:App/STM32F4-Discovery/spi.c **** /*============================================================================
  11:App/STM32F4-Discovery/spi.c ****  * 	func void init_SPIx(void)
  12:App/STM32F4-Discovery/spi.c ****  *===========================================================================*/ 
  13:App/STM32F4-Discovery/spi.c **** void init_SPIx(void){
  46              		.loc 1 13 0
  47              		.cfi_startproc
  48              		@ args = 0, pretend = 0, frame = 96
  49              		@ frame_needed = 1, uses_anonymous_args = 0
  50 0000 80B5     		push	{r7, lr}
  51              	.LCFI0:
  52              		.cfi_def_cfa_offset 8
  53              		.cfi_offset 7, -8
  54              		.cfi_offset 14, -4
  55 0002 98B0     		sub	sp, sp, #96
  56              	.LCFI1:
  57              		.cfi_def_cfa_offset 104
  58 0004 00AF     		add	r7, sp, #0
  59              	.LCFI2:
  60              		.cfi_def_cfa_register 7
  14:App/STM32F4-Discovery/spi.c **** 	
  15:App/STM32F4-Discovery/spi.c **** 
  16:App/STM32F4-Discovery/spi.c **** 	/*! Initialize SPI pheriphial with DMA controller \n
  17:App/STM32F4-Discovery/spi.c **** 	 *  - SPI setup
  18:App/STM32F4-Discovery/spi.c **** 	 *  	+ MISO PA6
  19:App/STM32F4-Discovery/spi.c **** 	 *  	+ MOSI PA7
  20:App/STM32F4-Discovery/spi.c **** 	 *  	+ SCK PA5
  21:App/STM32F4-Discovery/spi.c **** 	 *	+ CS PA4
  22:App/STM32F4-Discovery/spi.c **** 	 *	+ HR pin PC5
  23:App/STM32F4-Discovery/spi.c **** 	 *\n
  24:App/STM32F4-Discovery/spi.c **** 	 */
  25:App/STM32F4-Discovery/spi.c **** 	GPIO_InitTypeDef GPIO_InitStruct;
  26:App/STM32F4-Discovery/spi.c **** 	SPI_InitTypeDef SPI_InitStruct;
  27:App/STM32F4-Discovery/spi.c **** 	DMA_InitTypeDef DMA_InitStruct;
  28:App/STM32F4-Discovery/spi.c **** 	NVIC_InitTypeDef NVIC_InitStruct;
  29:App/STM32F4-Discovery/spi.c **** 
  30:App/STM32F4-Discovery/spi.c **** 	
  31:App/STM32F4-Discovery/spi.c **** 	
  32:App/STM32F4-Discovery/spi.c **** 	// enable clock for used IO pins
  33:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd(SPIx_MOSI_GPIO_CLK, ENABLE);
  61              		.loc 1 33 0
  62 0006 0120     		movs	r0, #1
  63 0008 0121     		movs	r1, #1
  64 000a FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
  34:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd(SPIx_MISO_GPIO_CLK, ENABLE);
  65              		.loc 1 34 0
  66 000e 0120     		movs	r0, #1
  67 0010 0121     		movs	r1, #1
  68 0012 FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
  35:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd(SPIx_SCK_GPIO_CLK, ENABLE);
  69              		.loc 1 35 0
  70 0016 0120     		movs	r0, #1
  71 0018 0121     		movs	r1, #1
  72 001a FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
  36:App/STM32F4-Discovery/spi.c **** 	
  37:App/STM32F4-Discovery/spi.c **** 	/* configure pins used by SPIx
  38:App/STM32F4-Discovery/spi.c **** 	 * PA5 = SCK
  39:App/STM32F4-Discovery/spi.c **** 	 * PA6 = MISO
  40:App/STM32F4-Discovery/spi.c **** 	 * PA7 = MOSI
  41:App/STM32F4-Discovery/spi.c **** 	 */
  42:App/STM32F4-Discovery/spi.c **** 	// MOSI PA7
  43:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIx_MOSI_PIN ;
  73              		.loc 1 43 0
  74 001e 8023     		movs	r3, #128
  75 0020 BB65     		str	r3, [r7, #88]
  44:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;
  76              		.loc 1 44 0
  77 0022 0223     		movs	r3, #2
  78 0024 87F85C30 		strb	r3, [r7, #92]
  45:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
  79              		.loc 1 45 0
  80 0028 0023     		movs	r3, #0
  81 002a 87F85E30 		strb	r3, [r7, #94]
  46:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
  82              		.loc 1 46 0
  83 002e 0323     		movs	r3, #3
  84 0030 87F85D30 		strb	r3, [r7, #93]
  47:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_DOWN;
  85              		.loc 1 47 0
  86 0034 0223     		movs	r3, #2
  87 0036 87F85F30 		strb	r3, [r7, #95]
  48:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIx_MOSI_GPIO_PORT, &GPIO_InitStruct);
  88              		.loc 1 48 0
  89 003a 07F15803 		add	r3, r7, #88
  90 003e 8748     		ldr	r0, .L4
  91 0040 1946     		mov	r1, r3
  92 0042 FFF7FEFF 		bl	GPIO_Init
  49:App/STM32F4-Discovery/spi.c **** 	// SCK PA5
  50:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIx_SCK_PIN;
  93              		.loc 1 50 0
  94 0046 2023     		movs	r3, #32
  95 0048 BB65     		str	r3, [r7, #88]
  51:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;
  96              		.loc 1 51 0
  97 004a 0223     		movs	r3, #2
  98 004c 87F85C30 		strb	r3, [r7, #92]
  52:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
  99              		.loc 1 52 0
 100 0050 0023     		movs	r3, #0
 101 0052 87F85E30 		strb	r3, [r7, #94]
  53:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
 102              		.loc 1 53 0
 103 0056 0323     		movs	r3, #3
 104 0058 87F85D30 		strb	r3, [r7, #93]
  54:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_DOWN;
 105              		.loc 1 54 0
 106 005c 0223     		movs	r3, #2
 107 005e 87F85F30 		strb	r3, [r7, #95]
  55:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIx_SCK_GPIO_PORT, &GPIO_InitStruct);
 108              		.loc 1 55 0
 109 0062 07F15803 		add	r3, r7, #88
 110 0066 7D48     		ldr	r0, .L4
 111 0068 1946     		mov	r1, r3
 112 006a FFF7FEFF 		bl	GPIO_Init
  56:App/STM32F4-Discovery/spi.c **** 	// MISO PA6
  57:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIx_MISO_PIN;
 113              		.loc 1 57 0
 114 006e 4023     		movs	r3, #64
 115 0070 BB65     		str	r3, [r7, #88]
  58:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;
 116              		.loc 1 58 0
 117 0072 0223     		movs	r3, #2
 118 0074 87F85C30 		strb	r3, [r7, #92]
  59:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_OD;
 119              		.loc 1 59 0
 120 0078 0123     		movs	r3, #1
 121 007a 87F85E30 		strb	r3, [r7, #94]
  60:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
 122              		.loc 1 60 0
 123 007e 0323     		movs	r3, #3
 124 0080 87F85D30 		strb	r3, [r7, #93]
  61:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_NOPULL;
 125              		.loc 1 61 0
 126 0084 0023     		movs	r3, #0
 127 0086 87F85F30 		strb	r3, [r7, #95]
  62:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIx_MISO_GPIO_PORT, &GPIO_InitStruct);
 128              		.loc 1 62 0
 129 008a 07F15803 		add	r3, r7, #88
 130 008e 7348     		ldr	r0, .L4
 131 0090 1946     		mov	r1, r3
 132 0092 FFF7FEFF 		bl	GPIO_Init
  63:App/STM32F4-Discovery/spi.c **** 	
  64:App/STM32F4-Discovery/spi.c **** 	// connect SPIx pins to SPI alternate function
  65:App/STM32F4-Discovery/spi.c **** 	GPIO_PinAFConfig(SPIx_MISO_GPIO_PORT, SPIx_MISO_SOURCE, SPIx_MISO_AF);
 133              		.loc 1 65 0
 134 0096 7148     		ldr	r0, .L4
 135 0098 0621     		movs	r1, #6
 136 009a 0522     		movs	r2, #5
 137 009c FFF7FEFF 		bl	GPIO_PinAFConfig
  66:App/STM32F4-Discovery/spi.c **** 	GPIO_PinAFConfig(SPIx_MOSI_GPIO_PORT, SPIx_MOSI_SOURCE, SPIx_MOSI_AF);
 138              		.loc 1 66 0
 139 00a0 6E48     		ldr	r0, .L4
 140 00a2 0721     		movs	r1, #7
 141 00a4 0522     		movs	r2, #5
 142 00a6 FFF7FEFF 		bl	GPIO_PinAFConfig
  67:App/STM32F4-Discovery/spi.c **** 	GPIO_PinAFConfig(SPIx_SCK_GPIO_PORT,  SPIx_SCK_SOURCE,  SPIx_SCK_AF);
 143              		.loc 1 67 0
 144 00aa 6C48     		ldr	r0, .L4
 145 00ac 0521     		movs	r1, #5
 146 00ae 0522     		movs	r2, #5
 147 00b0 FFF7FEFF 		bl	GPIO_PinAFConfig
  68:App/STM32F4-Discovery/spi.c **** 
  69:App/STM32F4-Discovery/spi.c **** 		
  70:App/STM32F4-Discovery/spi.c **** 	/* Configure the chip select pin
  71:App/STM32F4-Discovery/spi.c **** 	   in this case we will use PA4 */
  72:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIx_CS_PIN;
 148              		.loc 1 72 0
 149 00b4 1023     		movs	r3, #16
 150 00b6 BB65     		str	r3, [r7, #88]
  73:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_OUT;
 151              		.loc 1 73 0
 152 00b8 0123     		movs	r3, #1
 153 00ba 87F85C30 		strb	r3, [r7, #92]
  74:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
 154              		.loc 1 74 0
 155 00be 0023     		movs	r3, #0
 156 00c0 87F85E30 		strb	r3, [r7, #94]
  75:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
 157              		.loc 1 75 0
 158 00c4 0323     		movs	r3, #3
 159 00c6 87F85D30 		strb	r3, [r7, #93]
  76:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_UP;
 160              		.loc 1 76 0
 161 00ca 0123     		movs	r3, #1
 162 00cc 87F85F30 		strb	r3, [r7, #95]
  77:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIx_CS_GPIO_PORT, &GPIO_InitStruct);
 163              		.loc 1 77 0
 164 00d0 07F15803 		add	r3, r7, #88
 165 00d4 6148     		ldr	r0, .L4
 166 00d6 1946     		mov	r1, r3
 167 00d8 FFF7FEFF 		bl	GPIO_Init
  78:App/STM32F4-Discovery/spi.c **** 	
  79:App/STM32F4-Discovery/spi.c **** 	CSOFFx(); // set PA4 high
 168              		.loc 1 79 0
 169 00dc 5F4B     		ldr	r3, .L4
 170 00de 5F4A     		ldr	r2, .L4
 171 00e0 128B     		ldrh	r2, [r2, #24]	@ movhi
 172 00e2 92B2     		uxth	r2, r2
 173 00e4 42F01002 		orr	r2, r2, #16
 174 00e8 92B2     		uxth	r2, r2
 175 00ea 1A83     		strh	r2, [r3, #24]	@ movhi
  80:App/STM32F4-Discovery/spi.c **** 
  81:App/STM32F4-Discovery/spi.c **** 
  82:App/STM32F4-Discovery/spi.c **** 	// enable peripheral clock
  83:App/STM32F4-Discovery/spi.c **** 	RCC_APB2PeriphClockCmd(SPIx_CLK, ENABLE);
 176              		.loc 1 83 0
 177 00ec 4FF48050 		mov	r0, #4096
 178 00f0 0121     		movs	r1, #1
 179 00f2 FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
  84:App/STM32F4-Discovery/spi.c **** 	
  85:App/STM32F4-Discovery/spi.c **** 	/* configure SPIx in Mode 0 
  86:App/STM32F4-Discovery/spi.c **** 	 * CPOL = 0 --> clock is low when idle
  87:App/STM32F4-Discovery/spi.c **** 	 * CPHA = 0 --> data is sampled at the first edge
  88:App/STM32F4-Discovery/spi.c **** 	 */
  89:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_Direction = SPI_Direction_2Lines_FullDuplex; // set to full duplex mode, sepera
 180              		.loc 1 89 0
 181 00f6 0023     		movs	r3, #0
 182 00f8 A7F84430 		strh	r3, [r7, #68]	@ movhi
  90:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_Mode = SPI_Mode_Master;     // transmit in master mode, NSS pin has to be alway
 183              		.loc 1 90 0
 184 00fc 4FF48273 		mov	r3, #260
 185 0100 A7F84630 		strh	r3, [r7, #70]	@ movhi
  91:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_DataSize = SPI_DataSize_8b; // one packet of data is 8 bits wide
 186              		.loc 1 91 0
 187 0104 0023     		movs	r3, #0
 188 0106 A7F84830 		strh	r3, [r7, #72]	@ movhi
  92:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_CPOL = SPI_CPOL_Low;        // clock is low when idle
 189              		.loc 1 92 0
 190 010a 0023     		movs	r3, #0
 191 010c A7F84A30 		strh	r3, [r7, #74]	@ movhi
  93:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_CPHA = SPI_CPHA_1Edge;      // data sampled at second edge
 192              		.loc 1 93 0
 193 0110 0023     		movs	r3, #0
 194 0112 A7F84C30 		strh	r3, [r7, #76]	@ movhi
  94:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_NSS = SPI_NSS_Soft | SPI_NSSInternalSoft_Set; // set the NSS management to inte
 195              		.loc 1 94 0
 196 0116 4FF44073 		mov	r3, #768
 197 011a A7F84E30 		strh	r3, [r7, #78]	@ movhi
  95:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_BaudRatePrescaler = SPI_BaudRatePrescaler_4; // SPI frequency is APB2 frequency
 198              		.loc 1 95 0
 199 011e 0823     		movs	r3, #8
 200 0120 A7F85030 		strh	r3, [r7, #80]	@ movhi
  96:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_FirstBit = SPI_FirstBit_MSB;// data is transmitted MSB first
 201              		.loc 1 96 0
 202 0124 0023     		movs	r3, #0
 203 0126 A7F85230 		strh	r3, [r7, #82]	@ movhi
  97:App/STM32F4-Discovery/spi.c **** 	SPI_Init(SPIx, &SPI_InitStruct); 
 204              		.loc 1 97 0
 205 012a 07F14403 		add	r3, r7, #68
 206 012e 4C48     		ldr	r0, .L4+4
 207 0130 1946     		mov	r1, r3
 208 0132 FFF7FEFF 		bl	SPI_Init
  98:App/STM32F4-Discovery/spi.c **** 	
  99:App/STM32F4-Discovery/spi.c **** 	SPI_Cmd(SPIx, ENABLE);			
 209              		.loc 1 99 0
 210 0136 4A48     		ldr	r0, .L4+4
 211 0138 0121     		movs	r1, #1
 212 013a FFF7FEFF 		bl	SPI_Cmd
 100:App/STM32F4-Discovery/spi.c **** 	
 101:App/STM32F4-Discovery/spi.c **** 
 102:App/STM32F4-Discovery/spi.c **** 	/* setup DMA */
 103:App/STM32F4-Discovery/spi.c **** 
 104:App/STM32F4-Discovery/spi.c **** 	// enable clock 
 105:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd (SPIx_DMA_CLK, ENABLE); 
 213              		.loc 1 105 0
 214 013e 4FF48000 		mov	r0, #4194304
 215 0142 0121     		movs	r1, #1
 216 0144 FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
 106:App/STM32F4-Discovery/spi.c **** 	
 107:App/STM32F4-Discovery/spi.c **** 	// start with blank DMA configuration
 108:App/STM32F4-Discovery/spi.c **** 	DMA_DeInit (SPIx_TX_DMA_STREAM);
 217              		.loc 1 108 0
 218 0148 4648     		ldr	r0, .L4+8
 219 014a FFF7FEFF 		bl	DMA_DeInit
 109:App/STM32F4-Discovery/spi.c **** 	DMA_DeInit (SPIx_RX_DMA_STREAM);
 220              		.loc 1 109 0
 221 014e 4648     		ldr	r0, .L4+12
 222 0150 FFF7FEFF 		bl	DMA_DeInit
 110:App/STM32F4-Discovery/spi.c **** 
 111:App/STM32F4-Discovery/spi.c **** 	// check if DMA stream is disabled before enabling 
 112:App/STM32F4-Discovery/spi.c **** 	// this is useful when stream is enabled and disabled multiple times. 
 113:App/STM32F4-Discovery/spi.c **** 	while (DMA_GetCmdStatus (SPIx_TX_DMA_STREAM) != DISABLE);
 223              		.loc 1 113 0
 224 0154 00BF     		nop
 225              	.L2:
 226              		.loc 1 113 0 is_stmt 0 discriminator 1
 227 0156 4348     		ldr	r0, .L4+8
 228 0158 FFF7FEFF 		bl	DMA_GetCmdStatus
 229 015c 0346     		mov	r3, r0
 230 015e 002B     		cmp	r3, #0
 231 0160 F9D1     		bne	.L2
 114:App/STM32F4-Discovery/spi.c **** 	while (DMA_GetCmdStatus (SPIx_RX_DMA_STREAM) != DISABLE);
 232              		.loc 1 114 0 is_stmt 1
 233 0162 00BF     		nop
 234              	.L3:
 235              		.loc 1 114 0 is_stmt 0 discriminator 1
 236 0164 4048     		ldr	r0, .L4+12
 237 0166 FFF7FEFF 		bl	DMA_GetCmdStatus
 238 016a 0346     		mov	r3, r0
 239 016c 002B     		cmp	r3, #0
 240 016e F9D1     		bne	.L3
 115:App/STM32F4-Discovery/spi.c **** 	
 116:App/STM32F4-Discovery/spi.c **** 	
 117:App/STM32F4-Discovery/spi.c **** 	DMA_StructInit(&DMA_InitStruct);
 241              		.loc 1 117 0 is_stmt 1
 242 0170 07F10803 		add	r3, r7, #8
 243 0174 1846     		mov	r0, r3
 244 0176 FFF7FEFF 		bl	DMA_StructInit
 118:App/STM32F4-Discovery/spi.c ****   	//Configure DMA Initialization Structure
 119:App/STM32F4-Discovery/spi.c **** 	//DMA_InitStruct.DMA_FIFOMode = DMA_FIFOMode_Disable ;
 120:App/STM32F4-Discovery/spi.c ****  	//DMA_InitStruct.DMA_FIFOThreshold = DMA_FIFOThreshold_HalfFull ;
 121:App/STM32F4-Discovery/spi.c ****   	//DMA_InitStruct.DMA_MemoryBurst = DMA_MemoryBurst_Single ;
 122:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_MemoryDataSize = DMA_MemoryDataSize_Byte;
 245              		.loc 1 122 0
 246 017a 0023     		movs	r3, #0
 247 017c BB62     		str	r3, [r7, #40]
 123:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_MemoryInc = DMA_MemoryInc_Enable;
 248              		.loc 1 123 0
 249 017e 4FF48063 		mov	r3, #1024
 250 0182 3B62     		str	r3, [r7, #32]
 124:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Mode = DMA_Mode_Normal;
 251              		.loc 1 124 0
 252 0184 0023     		movs	r3, #0
 253 0186 FB62     		str	r3, [r7, #44]
 125:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralBaseAddr =(uint32_t) (&(SPIx->DR)) ;
 254              		.loc 1 125 0
 255 0188 384B     		ldr	r3, .L4+16
 256 018a FB60     		str	r3, [r7, #12]
 126:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralBurst = DMA_PeripheralBurst_Single;
 257              		.loc 1 126 0
 258 018c 0023     		movs	r3, #0
 259 018e 3B64     		str	r3, [r7, #64]
 127:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Byte;
 260              		.loc 1 127 0
 261 0190 0023     		movs	r3, #0
 262 0192 7B62     		str	r3, [r7, #36]
 128:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
 263              		.loc 1 128 0
 264 0194 0023     		movs	r3, #0
 265 0196 FB61     		str	r3, [r7, #28]
 129:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Priority = DMA_Priority_High;
 266              		.loc 1 129 0
 267 0198 4FF40033 		mov	r3, #131072
 268 019c 3B63     		str	r3, [r7, #48]
 130:App/STM32F4-Discovery/spi.c ****   	// Configure TX DMA 
 131:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Channel = SPIx_TX_DMA_CHANNEL ;
 269              		.loc 1 131 0
 270 019e 4FF0C063 		mov	r3, #100663296
 271 01a2 BB60     		str	r3, [r7, #8]
 132:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_DIR = DMA_DIR_MemoryToPeripheral ;
 272              		.loc 1 132 0
 273 01a4 4023     		movs	r3, #64
 274 01a6 7B61     		str	r3, [r7, #20]
 133:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Memory0BaseAddr = (uint32_t) &bufferTX ;
 275              		.loc 1 133 0
 276 01a8 314B     		ldr	r3, .L4+20
 277 01aa 3B61     		str	r3, [r7, #16]
 134:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_BufferSize = MAX_BUFFER_LENGTH;
 278              		.loc 1 134 0
 279 01ac 4FF4FA63 		mov	r3, #2000
 280 01b0 BB61     		str	r3, [r7, #24]
 135:App/STM32F4-Discovery/spi.c ****   	DMA_Init(SPIx_TX_DMA_STREAM, &DMA_InitStruct);
 281              		.loc 1 135 0
 282 01b2 07F10803 		add	r3, r7, #8
 283 01b6 2B48     		ldr	r0, .L4+8
 284 01b8 1946     		mov	r1, r3
 285 01ba FFF7FEFF 		bl	DMA_Init
 136:App/STM32F4-Discovery/spi.c **** 	// Configure RX DMA 
 137:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Channel = SPIx_RX_DMA_CHANNEL ;
 286              		.loc 1 137 0
 287 01be 4FF0C063 		mov	r3, #100663296
 288 01c2 BB60     		str	r3, [r7, #8]
 138:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_DIR = DMA_DIR_PeripheralToMemory ;
 289              		.loc 1 138 0
 290 01c4 0023     		movs	r3, #0
 291 01c6 7B61     		str	r3, [r7, #20]
 139:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_Memory0BaseAddr = (uint32_t)&bufferRX; 
 292              		.loc 1 139 0
 293 01c8 2A4B     		ldr	r3, .L4+24
 294 01ca 3B61     		str	r3, [r7, #16]
 140:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_BufferSize = MAX_BUFFER_LENGTH;
 295              		.loc 1 140 0
 296 01cc 4FF4FA63 		mov	r3, #2000
 297 01d0 BB61     		str	r3, [r7, #24]
 141:App/STM32F4-Discovery/spi.c **** 	DMA_Init(SPIx_RX_DMA_STREAM, &DMA_InitStruct);	
 298              		.loc 1 141 0
 299 01d2 07F10803 		add	r3, r7, #8
 300 01d6 2448     		ldr	r0, .L4+12
 301 01d8 1946     		mov	r1, r3
 302 01da FFF7FEFF 		bl	DMA_Init
 142:App/STM32F4-Discovery/spi.c **** 	
 143:App/STM32F4-Discovery/spi.c **** 	DMA_ITConfig(SPIx_TX_DMA_STREAM, DMA_IT_TC, ENABLE); 
 303              		.loc 1 143 0
 304 01de 2148     		ldr	r0, .L4+8
 305 01e0 1021     		movs	r1, #16
 306 01e2 0122     		movs	r2, #1
 307 01e4 FFF7FEFF 		bl	DMA_ITConfig
 144:App/STM32F4-Discovery/spi.c **** 	DMA_ITConfig(SPIx_RX_DMA_STREAM, DMA_IT_TC, ENABLE); 
 308              		.loc 1 144 0
 309 01e8 1F48     		ldr	r0, .L4+12
 310 01ea 1021     		movs	r1, #16
 311 01ec 0122     		movs	r2, #1
 312 01ee FFF7FEFF 		bl	DMA_ITConfig
 145:App/STM32F4-Discovery/spi.c ****   
 146:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_ClearFlag(SPIx, SPI_I2S_FLAG_TXE);
 313              		.loc 1 146 0
 314 01f2 1B48     		ldr	r0, .L4+4
 315 01f4 0221     		movs	r1, #2
 316 01f6 FFF7FEFF 		bl	SPI_I2S_ClearFlag
 147:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_ClearFlag(SPIx, SPI_I2S_FLAG_RXNE);
 317              		.loc 1 147 0
 318 01fa 1948     		ldr	r0, .L4+4
 319 01fc 0121     		movs	r1, #1
 320 01fe FFF7FEFF 		bl	SPI_I2S_ClearFlag
 148:App/STM32F4-Discovery/spi.c ****   	
 149:App/STM32F4-Discovery/spi.c **** 	// enable the interrupt in the NVIC
 150:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannel = SPIx_TX_DMA_IRQn;
 321              		.loc 1 150 0
 322 0202 3B23     		movs	r3, #59
 323 0204 3B71     		strb	r3, [r7, #4]
 151:App/STM32F4-Discovery/spi.c ****   	NVIC_InitStruct.NVIC_IRQChannelPreemptionPriority = configLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORITY
 324              		.loc 1 151 0
 325 0206 0723     		movs	r3, #7
 326 0208 7B71     		strb	r3, [r7, #5]
 152:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannelSubPriority = 0x1;
 327              		.loc 1 152 0
 328 020a 0123     		movs	r3, #1
 329 020c BB71     		strb	r3, [r7, #6]
 153:App/STM32F4-Discovery/spi.c ****   	NVIC_InitStruct.NVIC_IRQChannelCmd = ENABLE;
 330              		.loc 1 153 0
 331 020e 0123     		movs	r3, #1
 332 0210 FB71     		strb	r3, [r7, #7]
 154:App/STM32F4-Discovery/spi.c ****   	NVIC_Init (&NVIC_InitStruct);
 333              		.loc 1 154 0
 334 0212 3B1D     		adds	r3, r7, #4
 335 0214 1846     		mov	r0, r3
 336 0216 FFF7FEFF 		bl	NVIC_Init
 155:App/STM32F4-Discovery/spi.c **** 	// enable the interrupt in the NVIC
 156:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannel = SPIx_RX_DMA_IRQn;
 337              		.loc 1 156 0
 338 021a 3A23     		movs	r3, #58
 339 021c 3B71     		strb	r3, [r7, #4]
 157:App/STM32F4-Discovery/spi.c ****    	NVIC_InitStruct.NVIC_IRQChannelPreemptionPriority = configLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORIT
 340              		.loc 1 157 0
 341 021e 0723     		movs	r3, #7
 342 0220 7B71     		strb	r3, [r7, #5]
 158:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannelSubPriority = 0x1;
 343              		.loc 1 158 0
 344 0222 0123     		movs	r3, #1
 345 0224 BB71     		strb	r3, [r7, #6]
 159:App/STM32F4-Discovery/spi.c ****   	NVIC_InitStruct.NVIC_IRQChannelCmd = ENABLE;
 346              		.loc 1 159 0
 347 0226 0123     		movs	r3, #1
 348 0228 FB71     		strb	r3, [r7, #7]
 160:App/STM32F4-Discovery/spi.c ****   	NVIC_Init (&NVIC_InitStruct);
 349              		.loc 1 160 0
 350 022a 3B1D     		adds	r3, r7, #4
 351 022c 1846     		mov	r0, r3
 352 022e FFF7FEFF 		bl	NVIC_Init
 161:App/STM32F4-Discovery/spi.c ****   	// Enable dma tx and rx request
 162:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_DMACmd (SPIx, SPI_I2S_DMAReq_Tx, ENABLE);	
 353              		.loc 1 162 0
 354 0232 0B48     		ldr	r0, .L4+4
 355 0234 0221     		movs	r1, #2
 356 0236 0122     		movs	r2, #1
 357 0238 FFF7FEFF 		bl	SPI_I2S_DMACmd
 163:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_DMACmd (SPIx, SPI_I2S_DMAReq_Rx, ENABLE);	
 358              		.loc 1 163 0
 359 023c 0848     		ldr	r0, .L4+4
 360 023e 0121     		movs	r1, #1
 361 0240 0122     		movs	r2, #1
 362 0242 FFF7FEFF 		bl	SPI_I2S_DMACmd
 164:App/STM32F4-Discovery/spi.c **** 
 165:App/STM32F4-Discovery/spi.c **** 	xSemaphoreDMASPIx = xSemaphoreCreateBinary();
 363              		.loc 1 165 0
 364 0246 0120     		movs	r0, #1
 365 0248 0021     		movs	r1, #0
 366 024a 0322     		movs	r2, #3
 367 024c FFF7FEFF 		bl	xQueueGenericCreate
 368 0250 0246     		mov	r2, r0
 369 0252 094B     		ldr	r3, .L4+28
 370 0254 1A60     		str	r2, [r3]
 166:App/STM32F4-Discovery/spi.c **** 	
 167:App/STM32F4-Discovery/spi.c **** }
 371              		.loc 1 167 0
 372 0256 6037     		adds	r7, r7, #96
 373 0258 BD46     		mov	sp, r7
 374              		@ sp needed
 375 025a 80BD     		pop	{r7, pc}
 376              	.L5:
 377              		.align	2
 378              	.L4:
 379 025c 00000240 		.word	1073872896
 380 0260 00300140 		.word	1073819648
 381 0264 58640240 		.word	1073898584
 382 0268 40640240 		.word	1073898560
 383 026c 0C300140 		.word	1073819660
 384 0270 00000000 		.word	bufferTX
 385 0274 00000000 		.word	bufferRX
 386 0278 00000000 		.word	xSemaphoreDMASPIx
 387              		.cfi_endproc
 388              	.LFE110:
 390              		.section	.text.init_SPIy,"ax",%progbits
 391              		.align	2
 392              		.global	init_SPIy
 393              		.thumb
 394              		.thumb_func
 396              	init_SPIy:
 397              	.LFB111:
 168:App/STM32F4-Discovery/spi.c **** 
 169:App/STM32F4-Discovery/spi.c **** void init_SPIy(void){
 398              		.loc 1 169 0
 399              		.cfi_startproc
 400              		@ args = 0, pretend = 0, frame = 96
 401              		@ frame_needed = 1, uses_anonymous_args = 0
 402 0000 80B5     		push	{r7, lr}
 403              	.LCFI3:
 404              		.cfi_def_cfa_offset 8
 405              		.cfi_offset 7, -8
 406              		.cfi_offset 14, -4
 407 0002 98B0     		sub	sp, sp, #96
 408              	.LCFI4:
 409              		.cfi_def_cfa_offset 104
 410 0004 00AF     		add	r7, sp, #0
 411              	.LCFI5:
 412              		.cfi_def_cfa_register 7
 170:App/STM32F4-Discovery/spi.c **** 	
 171:App/STM32F4-Discovery/spi.c **** 
 172:App/STM32F4-Discovery/spi.c **** 	/*! Initialize SPI pheriphial with DMA controller \n
 173:App/STM32F4-Discovery/spi.c **** 	 *  - SPI setup
 174:App/STM32F4-Discovery/spi.c **** 	 *  	+ MISO PA6
 175:App/STM32F4-Discovery/spi.c **** 	 *  	+ MOSI PA7
 176:App/STM32F4-Discovery/spi.c **** 	 *  	+ SCK PA5
 177:App/STM32F4-Discovery/spi.c **** 	 *	+ CS PA4
 178:App/STM32F4-Discovery/spi.c **** 	 *	+ HR pin PC5
 179:App/STM32F4-Discovery/spi.c **** 	 *\n
 180:App/STM32F4-Discovery/spi.c **** 	 * - WIZNET setup 
 181:App/STM32F4-Discovery/spi.c **** 	 *   	+ IT PC4 
 182:App/STM32F4-Discovery/spi.c **** 	 * */
 183:App/STM32F4-Discovery/spi.c **** 	GPIO_InitTypeDef GPIO_InitStruct;
 184:App/STM32F4-Discovery/spi.c **** 	SPI_InitTypeDef SPI_InitStruct;
 185:App/STM32F4-Discovery/spi.c **** 	DMA_InitTypeDef DMA_InitStruct;
 186:App/STM32F4-Discovery/spi.c **** 	NVIC_InitTypeDef NVIC_InitStruct;
 187:App/STM32F4-Discovery/spi.c **** 
 188:App/STM32F4-Discovery/spi.c **** 	
 189:App/STM32F4-Discovery/spi.c **** 	
 190:App/STM32F4-Discovery/spi.c **** 	// enable clock for used IO pins
 191:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd(SPIy_MOSI_GPIO_CLK, ENABLE);
 413              		.loc 1 191 0
 414 0006 0120     		movs	r0, #1
 415 0008 0121     		movs	r1, #1
 416 000a FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
 192:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd(SPIy_MISO_GPIO_CLK, ENABLE);
 417              		.loc 1 192 0
 418 000e 0120     		movs	r0, #1
 419 0010 0121     		movs	r1, #1
 420 0012 FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
 193:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd(SPIy_SCK_GPIO_CLK, ENABLE);
 421              		.loc 1 193 0
 422 0016 0120     		movs	r0, #1
 423 0018 0121     		movs	r1, #1
 424 001a FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
 194:App/STM32F4-Discovery/spi.c **** 	
 195:App/STM32F4-Discovery/spi.c **** 	/* configure pins used by SPIx
 196:App/STM32F4-Discovery/spi.c **** 	 * PA5 = SCK
 197:App/STM32F4-Discovery/spi.c **** 	 * PA6 = MISO
 198:App/STM32F4-Discovery/spi.c **** 	 * PA7 = MOSI
 199:App/STM32F4-Discovery/spi.c **** 	 */
 200:App/STM32F4-Discovery/spi.c **** 	// MOSI PA7
 201:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIy_MOSI_PIN ;
 425              		.loc 1 201 0
 426 001e 8023     		movs	r3, #128
 427 0020 BB65     		str	r3, [r7, #88]
 202:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;
 428              		.loc 1 202 0
 429 0022 0223     		movs	r3, #2
 430 0024 87F85C30 		strb	r3, [r7, #92]
 203:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
 431              		.loc 1 203 0
 432 0028 0023     		movs	r3, #0
 433 002a 87F85E30 		strb	r3, [r7, #94]
 204:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
 434              		.loc 1 204 0
 435 002e 0323     		movs	r3, #3
 436 0030 87F85D30 		strb	r3, [r7, #93]
 205:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_DOWN;
 437              		.loc 1 205 0
 438 0034 0223     		movs	r3, #2
 439 0036 87F85F30 		strb	r3, [r7, #95]
 206:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIy_MOSI_GPIO_PORT, &GPIO_InitStruct);
 440              		.loc 1 206 0
 441 003a 07F15803 		add	r3, r7, #88
 442 003e 8748     		ldr	r0, .L9
 443 0040 1946     		mov	r1, r3
 444 0042 FFF7FEFF 		bl	GPIO_Init
 207:App/STM32F4-Discovery/spi.c **** 	// SCK PA5
 208:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIy_SCK_PIN;
 445              		.loc 1 208 0
 446 0046 2023     		movs	r3, #32
 447 0048 BB65     		str	r3, [r7, #88]
 209:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;
 448              		.loc 1 209 0
 449 004a 0223     		movs	r3, #2
 450 004c 87F85C30 		strb	r3, [r7, #92]
 210:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
 451              		.loc 1 210 0
 452 0050 0023     		movs	r3, #0
 453 0052 87F85E30 		strb	r3, [r7, #94]
 211:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
 454              		.loc 1 211 0
 455 0056 0323     		movs	r3, #3
 456 0058 87F85D30 		strb	r3, [r7, #93]
 212:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_DOWN;
 457              		.loc 1 212 0
 458 005c 0223     		movs	r3, #2
 459 005e 87F85F30 		strb	r3, [r7, #95]
 213:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIy_SCK_GPIO_PORT, &GPIO_InitStruct);
 460              		.loc 1 213 0
 461 0062 07F15803 		add	r3, r7, #88
 462 0066 7D48     		ldr	r0, .L9
 463 0068 1946     		mov	r1, r3
 464 006a FFF7FEFF 		bl	GPIO_Init
 214:App/STM32F4-Discovery/spi.c **** 	// MISO PA6
 215:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIy_MISO_PIN;
 465              		.loc 1 215 0
 466 006e 4023     		movs	r3, #64
 467 0070 BB65     		str	r3, [r7, #88]
 216:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_AF;
 468              		.loc 1 216 0
 469 0072 0223     		movs	r3, #2
 470 0074 87F85C30 		strb	r3, [r7, #92]
 217:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_OD;
 471              		.loc 1 217 0
 472 0078 0123     		movs	r3, #1
 473 007a 87F85E30 		strb	r3, [r7, #94]
 218:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
 474              		.loc 1 218 0
 475 007e 0323     		movs	r3, #3
 476 0080 87F85D30 		strb	r3, [r7, #93]
 219:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_NOPULL;
 477              		.loc 1 219 0
 478 0084 0023     		movs	r3, #0
 479 0086 87F85F30 		strb	r3, [r7, #95]
 220:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIy_MISO_GPIO_PORT, &GPIO_InitStruct);
 480              		.loc 1 220 0
 481 008a 07F15803 		add	r3, r7, #88
 482 008e 7348     		ldr	r0, .L9
 483 0090 1946     		mov	r1, r3
 484 0092 FFF7FEFF 		bl	GPIO_Init
 221:App/STM32F4-Discovery/spi.c **** 	
 222:App/STM32F4-Discovery/spi.c **** 	// connect SPIx pins to SPI alternate function
 223:App/STM32F4-Discovery/spi.c **** 	GPIO_PinAFConfig(SPIy_MISO_GPIO_PORT, SPIy_MISO_SOURCE, SPIy_MISO_AF);
 485              		.loc 1 223 0
 486 0096 7148     		ldr	r0, .L9
 487 0098 0621     		movs	r1, #6
 488 009a 0522     		movs	r2, #5
 489 009c FFF7FEFF 		bl	GPIO_PinAFConfig
 224:App/STM32F4-Discovery/spi.c **** 	GPIO_PinAFConfig(SPIy_MOSI_GPIO_PORT, SPIy_MOSI_SOURCE, SPIy_MOSI_AF);
 490              		.loc 1 224 0
 491 00a0 6E48     		ldr	r0, .L9
 492 00a2 0721     		movs	r1, #7
 493 00a4 0522     		movs	r2, #5
 494 00a6 FFF7FEFF 		bl	GPIO_PinAFConfig
 225:App/STM32F4-Discovery/spi.c **** 	GPIO_PinAFConfig(SPIy_SCK_GPIO_PORT,  SPIy_SCK_SOURCE,  SPIy_SCK_AF);
 495              		.loc 1 225 0
 496 00aa 6C48     		ldr	r0, .L9
 497 00ac 0521     		movs	r1, #5
 498 00ae 0522     		movs	r2, #5
 499 00b0 FFF7FEFF 		bl	GPIO_PinAFConfig
 226:App/STM32F4-Discovery/spi.c **** 
 227:App/STM32F4-Discovery/spi.c **** 		
 228:App/STM32F4-Discovery/spi.c **** 	/* Configure the chip select pin
 229:App/STM32F4-Discovery/spi.c **** 	   in this case we will use PA4 */
 230:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Pin = SPIy_CS_PIN;
 500              		.loc 1 230 0
 501 00b4 1023     		movs	r3, #16
 502 00b6 BB65     		str	r3, [r7, #88]
 231:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Mode = GPIO_Mode_OUT;
 503              		.loc 1 231 0
 504 00b8 0123     		movs	r3, #1
 505 00ba 87F85C30 		strb	r3, [r7, #92]
 232:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_OType = GPIO_OType_PP;
 506              		.loc 1 232 0
 507 00be 0023     		movs	r3, #0
 508 00c0 87F85E30 		strb	r3, [r7, #94]
 233:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_Speed = GPIO_Speed_100MHz;
 509              		.loc 1 233 0
 510 00c4 0323     		movs	r3, #3
 511 00c6 87F85D30 		strb	r3, [r7, #93]
 234:App/STM32F4-Discovery/spi.c **** 	GPIO_InitStruct.GPIO_PuPd = GPIO_PuPd_UP;
 512              		.loc 1 234 0
 513 00ca 0123     		movs	r3, #1
 514 00cc 87F85F30 		strb	r3, [r7, #95]
 235:App/STM32F4-Discovery/spi.c **** 	GPIO_Init(SPIy_CS_GPIO_PORT, &GPIO_InitStruct);
 515              		.loc 1 235 0
 516 00d0 07F15803 		add	r3, r7, #88
 517 00d4 6148     		ldr	r0, .L9
 518 00d6 1946     		mov	r1, r3
 519 00d8 FFF7FEFF 		bl	GPIO_Init
 236:App/STM32F4-Discovery/spi.c **** 	
 237:App/STM32F4-Discovery/spi.c **** 	CSOFFy(); // set PA4 high
 520              		.loc 1 237 0
 521 00dc 5F4B     		ldr	r3, .L9
 522 00de 5F4A     		ldr	r2, .L9
 523 00e0 128B     		ldrh	r2, [r2, #24]	@ movhi
 524 00e2 92B2     		uxth	r2, r2
 525 00e4 42F01002 		orr	r2, r2, #16
 526 00e8 92B2     		uxth	r2, r2
 527 00ea 1A83     		strh	r2, [r3, #24]	@ movhi
 238:App/STM32F4-Discovery/spi.c **** 
 239:App/STM32F4-Discovery/spi.c **** 
 240:App/STM32F4-Discovery/spi.c **** 	// enable peripheral clock
 241:App/STM32F4-Discovery/spi.c **** 	RCC_APB2PeriphClockCmd(SPIy_CLK, ENABLE);
 528              		.loc 1 241 0
 529 00ec 4FF48050 		mov	r0, #4096
 530 00f0 0121     		movs	r1, #1
 531 00f2 FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 242:App/STM32F4-Discovery/spi.c **** 	
 243:App/STM32F4-Discovery/spi.c **** 	/* configure SPIx in Mode 0 
 244:App/STM32F4-Discovery/spi.c **** 	 * CPOL = 0 --> clock is low when idle
 245:App/STM32F4-Discovery/spi.c **** 	 * CPHA = 0 --> data is sampled at the first edge
 246:App/STM32F4-Discovery/spi.c **** 	 */
 247:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_Direction = SPI_Direction_2Lines_FullDuplex; // set to full duplex mode, sepera
 532              		.loc 1 247 0
 533 00f6 0023     		movs	r3, #0
 534 00f8 A7F84430 		strh	r3, [r7, #68]	@ movhi
 248:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_Mode = SPI_Mode_Master;     // transmit in master mode, NSS pin has to be alway
 535              		.loc 1 248 0
 536 00fc 4FF48273 		mov	r3, #260
 537 0100 A7F84630 		strh	r3, [r7, #70]	@ movhi
 249:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_DataSize = SPI_DataSize_8b; // one packet of data is 8 bits wide
 538              		.loc 1 249 0
 539 0104 0023     		movs	r3, #0
 540 0106 A7F84830 		strh	r3, [r7, #72]	@ movhi
 250:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_CPOL = SPI_CPOL_Low;        // clock is low when idle
 541              		.loc 1 250 0
 542 010a 0023     		movs	r3, #0
 543 010c A7F84A30 		strh	r3, [r7, #74]	@ movhi
 251:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_CPHA = SPI_CPHA_1Edge;      // data sampled at second edge
 544              		.loc 1 251 0
 545 0110 0023     		movs	r3, #0
 546 0112 A7F84C30 		strh	r3, [r7, #76]	@ movhi
 252:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_NSS = SPI_NSS_Soft | SPI_NSSInternalSoft_Set; // set the NSS management to inte
 547              		.loc 1 252 0
 548 0116 4FF44073 		mov	r3, #768
 549 011a A7F84E30 		strh	r3, [r7, #78]	@ movhi
 253:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_BaudRatePrescaler = SPI_BaudRatePrescaler_4; // SPI frequency is APB2 frequency
 550              		.loc 1 253 0
 551 011e 0823     		movs	r3, #8
 552 0120 A7F85030 		strh	r3, [r7, #80]	@ movhi
 254:App/STM32F4-Discovery/spi.c **** 	SPI_InitStruct.SPI_FirstBit = SPI_FirstBit_MSB;// data is transmitted MSB first
 553              		.loc 1 254 0
 554 0124 0023     		movs	r3, #0
 555 0126 A7F85230 		strh	r3, [r7, #82]	@ movhi
 255:App/STM32F4-Discovery/spi.c **** 	SPI_Init(SPIy, &SPI_InitStruct); 
 556              		.loc 1 255 0
 557 012a 07F14403 		add	r3, r7, #68
 558 012e 4C48     		ldr	r0, .L9+4
 559 0130 1946     		mov	r1, r3
 560 0132 FFF7FEFF 		bl	SPI_Init
 256:App/STM32F4-Discovery/spi.c **** 	
 257:App/STM32F4-Discovery/spi.c **** 	SPI_Cmd(SPIy, ENABLE);			
 561              		.loc 1 257 0
 562 0136 4A48     		ldr	r0, .L9+4
 563 0138 0121     		movs	r1, #1
 564 013a FFF7FEFF 		bl	SPI_Cmd
 258:App/STM32F4-Discovery/spi.c **** 	
 259:App/STM32F4-Discovery/spi.c **** 
 260:App/STM32F4-Discovery/spi.c **** 	/* setup DMA */
 261:App/STM32F4-Discovery/spi.c **** 
 262:App/STM32F4-Discovery/spi.c **** 	// enable clock 
 263:App/STM32F4-Discovery/spi.c **** 	RCC_AHB1PeriphClockCmd (SPIy_DMA_CLK, ENABLE); 
 565              		.loc 1 263 0
 566 013e 4FF48000 		mov	r0, #4194304
 567 0142 0121     		movs	r1, #1
 568 0144 FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
 264:App/STM32F4-Discovery/spi.c **** 	
 265:App/STM32F4-Discovery/spi.c **** 	// start with blank DMA configuration
 266:App/STM32F4-Discovery/spi.c **** 	DMA_DeInit (SPIy_TX_DMA_STREAM);
 569              		.loc 1 266 0
 570 0148 4648     		ldr	r0, .L9+8
 571 014a FFF7FEFF 		bl	DMA_DeInit
 267:App/STM32F4-Discovery/spi.c **** 	DMA_DeInit (SPIy_RX_DMA_STREAM);
 572              		.loc 1 267 0
 573 014e 4648     		ldr	r0, .L9+12
 574 0150 FFF7FEFF 		bl	DMA_DeInit
 268:App/STM32F4-Discovery/spi.c **** 
 269:App/STM32F4-Discovery/spi.c **** 	// check if DMA stream is disabled before enabling 
 270:App/STM32F4-Discovery/spi.c **** 	// this is useful when stream is enabled and disabled multiple times. 
 271:App/STM32F4-Discovery/spi.c **** 	while (DMA_GetCmdStatus (SPIy_TX_DMA_STREAM) != DISABLE);
 575              		.loc 1 271 0
 576 0154 00BF     		nop
 577              	.L7:
 578              		.loc 1 271 0 is_stmt 0 discriminator 1
 579 0156 4348     		ldr	r0, .L9+8
 580 0158 FFF7FEFF 		bl	DMA_GetCmdStatus
 581 015c 0346     		mov	r3, r0
 582 015e 002B     		cmp	r3, #0
 583 0160 F9D1     		bne	.L7
 272:App/STM32F4-Discovery/spi.c **** 	while (DMA_GetCmdStatus (SPIy_RX_DMA_STREAM) != DISABLE);
 584              		.loc 1 272 0 is_stmt 1
 585 0162 00BF     		nop
 586              	.L8:
 587              		.loc 1 272 0 is_stmt 0 discriminator 1
 588 0164 4048     		ldr	r0, .L9+12
 589 0166 FFF7FEFF 		bl	DMA_GetCmdStatus
 590 016a 0346     		mov	r3, r0
 591 016c 002B     		cmp	r3, #0
 592 016e F9D1     		bne	.L8
 273:App/STM32F4-Discovery/spi.c **** 	
 274:App/STM32F4-Discovery/spi.c **** 	
 275:App/STM32F4-Discovery/spi.c **** 	DMA_StructInit(&DMA_InitStruct);
 593              		.loc 1 275 0 is_stmt 1
 594 0170 07F10803 		add	r3, r7, #8
 595 0174 1846     		mov	r0, r3
 596 0176 FFF7FEFF 		bl	DMA_StructInit
 276:App/STM32F4-Discovery/spi.c ****   	//Configure DMA Initialization Structure
 277:App/STM32F4-Discovery/spi.c **** 	//DMA_InitStruct.DMA_FIFOMode = DMA_FIFOMode_Disable ;
 278:App/STM32F4-Discovery/spi.c ****  	//DMA_InitStruct.DMA_FIFOThreshold = DMA_FIFOThreshold_HalfFull ;
 279:App/STM32F4-Discovery/spi.c ****   	//DMA_InitStruct.DMA_MemoryBurst = DMA_MemoryBurst_Single ;
 280:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_MemoryDataSize = DMA_MemoryDataSize_Byte;
 597              		.loc 1 280 0
 598 017a 0023     		movs	r3, #0
 599 017c BB62     		str	r3, [r7, #40]
 281:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_MemoryInc = DMA_MemoryInc_Enable;
 600              		.loc 1 281 0
 601 017e 4FF48063 		mov	r3, #1024
 602 0182 3B62     		str	r3, [r7, #32]
 282:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Mode = DMA_Mode_Normal;
 603              		.loc 1 282 0
 604 0184 0023     		movs	r3, #0
 605 0186 FB62     		str	r3, [r7, #44]
 283:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralBaseAddr =(uint32_t) (&(SPIy->DR)) ;
 606              		.loc 1 283 0
 607 0188 384B     		ldr	r3, .L9+16
 608 018a FB60     		str	r3, [r7, #12]
 284:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralBurst = DMA_PeripheralBurst_Single;
 609              		.loc 1 284 0
 610 018c 0023     		movs	r3, #0
 611 018e 3B64     		str	r3, [r7, #64]
 285:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralDataSize = DMA_PeripheralDataSize_Byte;
 612              		.loc 1 285 0
 613 0190 0023     		movs	r3, #0
 614 0192 7B62     		str	r3, [r7, #36]
 286:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_PeripheralInc = DMA_PeripheralInc_Disable;
 615              		.loc 1 286 0
 616 0194 0023     		movs	r3, #0
 617 0196 FB61     		str	r3, [r7, #28]
 287:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Priority = DMA_Priority_High;
 618              		.loc 1 287 0
 619 0198 4FF40033 		mov	r3, #131072
 620 019c 3B63     		str	r3, [r7, #48]
 288:App/STM32F4-Discovery/spi.c ****   	// Configure TX DMA 
 289:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Channel = SPIy_TX_DMA_CHANNEL ;
 621              		.loc 1 289 0
 622 019e 4FF0C063 		mov	r3, #100663296
 623 01a2 BB60     		str	r3, [r7, #8]
 290:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_DIR = DMA_DIR_MemoryToPeripheral ;
 624              		.loc 1 290 0
 625 01a4 4023     		movs	r3, #64
 626 01a6 7B61     		str	r3, [r7, #20]
 291:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Memory0BaseAddr = (uint32_t) &bufferTX ;
 627              		.loc 1 291 0
 628 01a8 314B     		ldr	r3, .L9+20
 629 01aa 3B61     		str	r3, [r7, #16]
 292:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_BufferSize = MAX_BUFFER_LENGTH;
 630              		.loc 1 292 0
 631 01ac 4FF4FA63 		mov	r3, #2000
 632 01b0 BB61     		str	r3, [r7, #24]
 293:App/STM32F4-Discovery/spi.c ****   	DMA_Init(SPIy_TX_DMA_STREAM, &DMA_InitStruct);
 633              		.loc 1 293 0
 634 01b2 07F10803 		add	r3, r7, #8
 635 01b6 2B48     		ldr	r0, .L9+8
 636 01b8 1946     		mov	r1, r3
 637 01ba FFF7FEFF 		bl	DMA_Init
 294:App/STM32F4-Discovery/spi.c **** 	// Configure RX DMA 
 295:App/STM32F4-Discovery/spi.c ****   	DMA_InitStruct.DMA_Channel = SPIy_RX_DMA_CHANNEL ;
 638              		.loc 1 295 0
 639 01be 4FF0C063 		mov	r3, #100663296
 640 01c2 BB60     		str	r3, [r7, #8]
 296:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_DIR = DMA_DIR_PeripheralToMemory ;
 641              		.loc 1 296 0
 642 01c4 0023     		movs	r3, #0
 643 01c6 7B61     		str	r3, [r7, #20]
 297:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_Memory0BaseAddr = (uint32_t)&bufferRX; 
 644              		.loc 1 297 0
 645 01c8 2A4B     		ldr	r3, .L9+24
 646 01ca 3B61     		str	r3, [r7, #16]
 298:App/STM32F4-Discovery/spi.c **** 	DMA_InitStruct.DMA_BufferSize = MAX_BUFFER_LENGTH;
 647              		.loc 1 298 0
 648 01cc 4FF4FA63 		mov	r3, #2000
 649 01d0 BB61     		str	r3, [r7, #24]
 299:App/STM32F4-Discovery/spi.c **** 	DMA_Init(SPIy_RX_DMA_STREAM, &DMA_InitStruct);	
 650              		.loc 1 299 0
 651 01d2 07F10803 		add	r3, r7, #8
 652 01d6 2448     		ldr	r0, .L9+12
 653 01d8 1946     		mov	r1, r3
 654 01da FFF7FEFF 		bl	DMA_Init
 300:App/STM32F4-Discovery/spi.c **** 	
 301:App/STM32F4-Discovery/spi.c **** 	DMA_ITConfig(SPIy_TX_DMA_STREAM, DMA_IT_TC, ENABLE); 
 655              		.loc 1 301 0
 656 01de 2148     		ldr	r0, .L9+8
 657 01e0 1021     		movs	r1, #16
 658 01e2 0122     		movs	r2, #1
 659 01e4 FFF7FEFF 		bl	DMA_ITConfig
 302:App/STM32F4-Discovery/spi.c **** 	DMA_ITConfig(SPIy_RX_DMA_STREAM, DMA_IT_TC, ENABLE); 
 660              		.loc 1 302 0
 661 01e8 1F48     		ldr	r0, .L9+12
 662 01ea 1021     		movs	r1, #16
 663 01ec 0122     		movs	r2, #1
 664 01ee FFF7FEFF 		bl	DMA_ITConfig
 303:App/STM32F4-Discovery/spi.c ****   
 304:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_ClearFlag(SPIy, SPI_I2S_FLAG_TXE);
 665              		.loc 1 304 0
 666 01f2 1B48     		ldr	r0, .L9+4
 667 01f4 0221     		movs	r1, #2
 668 01f6 FFF7FEFF 		bl	SPI_I2S_ClearFlag
 305:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_ClearFlag(SPIy, SPI_I2S_FLAG_RXNE);
 669              		.loc 1 305 0
 670 01fa 1948     		ldr	r0, .L9+4
 671 01fc 0121     		movs	r1, #1
 672 01fe FFF7FEFF 		bl	SPI_I2S_ClearFlag
 306:App/STM32F4-Discovery/spi.c ****   	
 307:App/STM32F4-Discovery/spi.c **** 	// enable the interrupt in the NVIC
 308:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannel = SPIy_TX_DMA_IRQn;
 673              		.loc 1 308 0
 674 0202 3B23     		movs	r3, #59
 675 0204 3B71     		strb	r3, [r7, #4]
 309:App/STM32F4-Discovery/spi.c ****   	NVIC_InitStruct.NVIC_IRQChannelPreemptionPriority = configLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORITY
 676              		.loc 1 309 0
 677 0206 0723     		movs	r3, #7
 678 0208 7B71     		strb	r3, [r7, #5]
 310:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannelSubPriority = 0x1;
 679              		.loc 1 310 0
 680 020a 0123     		movs	r3, #1
 681 020c BB71     		strb	r3, [r7, #6]
 311:App/STM32F4-Discovery/spi.c ****   	NVIC_InitStruct.NVIC_IRQChannelCmd = ENABLE;
 682              		.loc 1 311 0
 683 020e 0123     		movs	r3, #1
 684 0210 FB71     		strb	r3, [r7, #7]
 312:App/STM32F4-Discovery/spi.c ****   	NVIC_Init (&NVIC_InitStruct);
 685              		.loc 1 312 0
 686 0212 3B1D     		adds	r3, r7, #4
 687 0214 1846     		mov	r0, r3
 688 0216 FFF7FEFF 		bl	NVIC_Init
 313:App/STM32F4-Discovery/spi.c **** 	// enable the interrupt in the NVIC
 314:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannel = SPIy_RX_DMA_IRQn;
 689              		.loc 1 314 0
 690 021a 3A23     		movs	r3, #58
 691 021c 3B71     		strb	r3, [r7, #4]
 315:App/STM32F4-Discovery/spi.c ****    	NVIC_InitStruct.NVIC_IRQChannelPreemptionPriority = configLIBRARY_MAX_SYSCALL_INTERRUPT_PRIORIT
 692              		.loc 1 315 0
 693 021e 0723     		movs	r3, #7
 694 0220 7B71     		strb	r3, [r7, #5]
 316:App/STM32F4-Discovery/spi.c ****  	NVIC_InitStruct.NVIC_IRQChannelSubPriority = 0x1;
 695              		.loc 1 316 0
 696 0222 0123     		movs	r3, #1
 697 0224 BB71     		strb	r3, [r7, #6]
 317:App/STM32F4-Discovery/spi.c ****   	NVIC_InitStruct.NVIC_IRQChannelCmd = ENABLE;
 698              		.loc 1 317 0
 699 0226 0123     		movs	r3, #1
 700 0228 FB71     		strb	r3, [r7, #7]
 318:App/STM32F4-Discovery/spi.c ****   	NVIC_Init (&NVIC_InitStruct);
 701              		.loc 1 318 0
 702 022a 3B1D     		adds	r3, r7, #4
 703 022c 1846     		mov	r0, r3
 704 022e FFF7FEFF 		bl	NVIC_Init
 319:App/STM32F4-Discovery/spi.c ****   	// Enable dma tx and rx request
 320:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_DMACmd (SPIy, SPI_I2S_DMAReq_Tx, ENABLE);	
 705              		.loc 1 320 0
 706 0232 0B48     		ldr	r0, .L9+4
 707 0234 0221     		movs	r1, #2
 708 0236 0122     		movs	r2, #1
 709 0238 FFF7FEFF 		bl	SPI_I2S_DMACmd
 321:App/STM32F4-Discovery/spi.c **** 	SPI_I2S_DMACmd (SPIy, SPI_I2S_DMAReq_Rx, ENABLE);	
 710              		.loc 1 321 0
 711 023c 0848     		ldr	r0, .L9+4
 712 023e 0121     		movs	r1, #1
 713 0240 0122     		movs	r2, #1
 714 0242 FFF7FEFF 		bl	SPI_I2S_DMACmd
 322:App/STM32F4-Discovery/spi.c **** 
 323:App/STM32F4-Discovery/spi.c **** 	xSemaphoreDMASPIy = xSemaphoreCreateBinary();
 715              		.loc 1 323 0
 716 0246 0120     		movs	r0, #1
 717 0248 0021     		movs	r1, #0
 718 024a 0322     		movs	r2, #3
 719 024c FFF7FEFF 		bl	xQueueGenericCreate
 720 0250 0246     		mov	r2, r0
 721 0252 094B     		ldr	r3, .L9+28
 722 0254 1A60     		str	r2, [r3]
 324:App/STM32F4-Discovery/spi.c **** 	
 325:App/STM32F4-Discovery/spi.c **** }
 723              		.loc 1 325 0
 724 0256 6037     		adds	r7, r7, #96
 725 0258 BD46     		mov	sp, r7
 726              		@ sp needed
 727 025a 80BD     		pop	{r7, pc}
 728              	.L10:
 729              		.align	2
 730              	.L9:
 731 025c 00000240 		.word	1073872896
 732 0260 00300140 		.word	1073819648
 733 0264 58640240 		.word	1073898584
 734 0268 40640240 		.word	1073898560
 735 026c 0C300140 		.word	1073819660
 736 0270 00000000 		.word	bufferTX
 737 0274 00000000 		.word	bufferRX
 738 0278 00000000 		.word	xSemaphoreDMASPIy
 739              		.cfi_endproc
 740              	.LFE111:
 742              		.section	.text.DMA2_Stream2_IRQHandler,"ax",%progbits
 743              		.align	2
 744              		.global	DMA2_Stream2_IRQHandler
 745              		.thumb
 746              		.thumb_func
 748              	DMA2_Stream2_IRQHandler:
 749              	.LFB112:
 326:App/STM32F4-Discovery/spi.c **** 
 327:App/STM32F4-Discovery/spi.c **** void DMA2_Stream2_IRQHandler()
 328:App/STM32F4-Discovery/spi.c **** {
 750              		.loc 1 328 0
 751              		.cfi_startproc
 752              		@ args = 0, pretend = 0, frame = 8
 753              		@ frame_needed = 1, uses_anonymous_args = 0
 754 0000 80B5     		push	{r7, lr}
 755              	.LCFI6:
 756              		.cfi_def_cfa_offset 8
 757              		.cfi_offset 7, -8
 758              		.cfi_offset 14, -4
 759 0002 82B0     		sub	sp, sp, #8
 760              	.LCFI7:
 761              		.cfi_def_cfa_offset 16
 762 0004 00AF     		add	r7, sp, #0
 763              	.LCFI8:
 764              		.cfi_def_cfa_register 7
 329:App/STM32F4-Discovery/spi.c **** 	/*!	\var static unsigned portBASE_TYPE xHigherPriorityTaskWoken
 330:App/STM32F4-Discovery/spi.c **** 	 * 	\brief Indicates if higher priority has been woken
 331:App/STM32F4-Discovery/spi.c **** 	 */
 332:App/STM32F4-Discovery/spi.c **** 
 333:App/STM32F4-Discovery/spi.c **** 	unsigned portBASE_TYPE xHigherPriorityTaskWoken = pdFalse;
 765              		.loc 1 333 0
 766 0006 0023     		movs	r3, #0
 767 0008 7B60     		str	r3, [r7, #4]
 334:App/STM32F4-Discovery/spi.c **** 
 335:App/STM32F4-Discovery/spi.c ****   // Test if DMA Stream Transfer Complete interrupt
 336:App/STM32F4-Discovery/spi.c ****   if (DMA_GetITStatus (SPIx_RX_DMA_STREAM, SPIx_RX_DMA_FLAG_TCIF)) {
 768              		.loc 1 336 0
 769 000a 1B48     		ldr	r0, .L15
 770 000c 1B49     		ldr	r1, .L15+4
 771 000e FFF7FEFF 		bl	DMA_GetITStatus
 772 0012 0346     		mov	r3, r0
 773 0014 002B     		cmp	r3, #0
 774 0016 24D0     		beq	.L12
 337:App/STM32F4-Discovery/spi.c ****     
 338:App/STM32F4-Discovery/spi.c **** 	DMA_ClearITPendingBit (SPIx_RX_DMA_STREAM, SPIx_RX_DMA_FLAG_TCIF);
 775              		.loc 1 338 0
 776 0018 1748     		ldr	r0, .L15
 777 001a 1849     		ldr	r1, .L15+4
 778 001c FFF7FEFF 		bl	DMA_ClearITPendingBit
 339:App/STM32F4-Discovery/spi.c **** 	
 340:App/STM32F4-Discovery/spi.c **** 	while (SPI_I2S_GetFlagStatus (SPIx, SPI_I2S_FLAG_BSY) == SET);
 779              		.loc 1 340 0
 780 0020 00BF     		nop
 781              	.L13:
 782              		.loc 1 340 0 is_stmt 0 discriminator 1
 783 0022 1748     		ldr	r0, .L15+8
 784 0024 8021     		movs	r1, #128
 785 0026 FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 786 002a 0346     		mov	r3, r0
 787 002c 012B     		cmp	r3, #1
 788 002e F8D0     		beq	.L13
 341:App/STM32F4-Discovery/spi.c ****     /*
 342:App/STM32F4-Discovery/spi.c ****      * The DMA stream is disabled in hardware at the end of the transfer
 343:App/STM32F4-Discovery/spi.c ****      * Now we can deselect the display. If more than one peripheral was being run
 344:App/STM32F4-Discovery/spi.c ****      * on this SPI peripheral, we would have to do both/all of them, or work out
 345:App/STM32F4-Discovery/spi.c ****      * which one was active and deselect that one.i
 346:App/STM32F4-Discovery/spi.c **** 	
 347:App/STM32F4-Discovery/spi.c ****      */
 348:App/STM32F4-Discovery/spi.c **** 	CSOFFx();
 789              		.loc 1 348 0 is_stmt 1
 790 0030 144B     		ldr	r3, .L15+12
 791 0032 144A     		ldr	r2, .L15+12
 792 0034 128B     		ldrh	r2, [r2, #24]	@ movhi
 793 0036 92B2     		uxth	r2, r2
 794 0038 42F01002 		orr	r2, r2, #16
 795 003c 92B2     		uxth	r2, r2
 796 003e 1A83     		strh	r2, [r3, #24]	@ movhi
 349:App/STM32F4-Discovery/spi.c **** 	DMA_Cmd(SPIx_RX_DMA_STREAM, DISABLE);		
 797              		.loc 1 349 0
 798 0040 0D48     		ldr	r0, .L15
 799 0042 0021     		movs	r1, #0
 800 0044 FFF7FEFF 		bl	DMA_Cmd
 350:App/STM32F4-Discovery/spi.c ****  
 351:App/STM32F4-Discovery/spi.c **** 	taskENTER_CRITICAL(); 
 801              		.loc 1 351 0
 802 0048 FFF7FEFF 		bl	vPortEnterCritical
 352:App/STM32F4-Discovery/spi.c **** //       xSemaphoreGive( xSemaphoreDMASPI);
 353:App/STM32F4-Discovery/spi.c **** 	xSemaphoreGiveFromISR( xSemaphoreDMASPIx, &xHigherPriorityTaskWoken );
 803              		.loc 1 353 0
 804 004c 0E4B     		ldr	r3, .L15+16
 805 004e 1A68     		ldr	r2, [r3]
 806 0050 3B1D     		adds	r3, r7, #4
 807 0052 1046     		mov	r0, r2
 808 0054 0021     		movs	r1, #0
 809 0056 1A46     		mov	r2, r3
 810 0058 0023     		movs	r3, #0
 811 005a FFF7FEFF 		bl	xQueueGenericSendFromISR
 354:App/STM32F4-Discovery/spi.c **** 	taskEXIT_CRITICAL(); //
 812              		.loc 1 354 0
 813 005e FFF7FEFF 		bl	vPortExitCritical
 814              	.L12:
 355:App/STM32F4-Discovery/spi.c ****   }	
 356:App/STM32F4-Discovery/spi.c ****  portEND_SWITCHING_ISR( xHigherPriorityTaskWoken );
 815              		.loc 1 356 0
 816 0062 7B68     		ldr	r3, [r7, #4]
 817 0064 002B     		cmp	r3, #0
 818 0066 03D0     		beq	.L11
 819              		.loc 1 356 0 is_stmt 0 discriminator 1
 820 0068 084B     		ldr	r3, .L15+20
 821 006a 4FF08052 		mov	r2, #268435456
 822 006e 1A60     		str	r2, [r3]
 823              	.L11:
 357:App/STM32F4-Discovery/spi.c **** }
 824              		.loc 1 357 0 is_stmt 1
 825 0070 0837     		adds	r7, r7, #8
 826 0072 BD46     		mov	sp, r7
 827              		@ sp needed
 828 0074 80BD     		pop	{r7, pc}
 829              	.L16:
 830 0076 00BF     		.align	2
 831              	.L15:
 832 0078 40640240 		.word	1073898560
 833 007c 00802010 		.word	270565376
 834 0080 00300140 		.word	1073819648
 835 0084 00000240 		.word	1073872896
 836 0088 00000000 		.word	xSemaphoreDMASPIx
 837 008c 04ED00E0 		.word	-536810236
 838              		.cfi_endproc
 839              	.LFE112:
 841              		.section	.text.DMA2_Stream3_IRQHandler,"ax",%progbits
 842              		.align	2
 843              		.global	DMA2_Stream3_IRQHandler
 844              		.thumb
 845              		.thumb_func
 847              	DMA2_Stream3_IRQHandler:
 848              	.LFB113:
 358:App/STM32F4-Discovery/spi.c **** void DMA2_Stream3_IRQHandler()
 359:App/STM32F4-Discovery/spi.c **** {
 849              		.loc 1 359 0
 850              		.cfi_startproc
 851              		@ args = 0, pretend = 0, frame = 8
 852              		@ frame_needed = 1, uses_anonymous_args = 0
 853 0000 80B5     		push	{r7, lr}
 854              	.LCFI9:
 855              		.cfi_def_cfa_offset 8
 856              		.cfi_offset 7, -8
 857              		.cfi_offset 14, -4
 858 0002 82B0     		sub	sp, sp, #8
 859              	.LCFI10:
 860              		.cfi_def_cfa_offset 16
 861 0004 00AF     		add	r7, sp, #0
 862              	.LCFI11:
 863              		.cfi_def_cfa_register 7
 360:App/STM32F4-Discovery/spi.c **** 	/*!	\var static unsigned portBASE_TYPE xHigherPriorityTaskWoken
 361:App/STM32F4-Discovery/spi.c **** 	 * 	\brief Indicates if higher priority has been woken
 362:App/STM32F4-Discovery/spi.c **** 	 */
 363:App/STM32F4-Discovery/spi.c **** 
 364:App/STM32F4-Discovery/spi.c **** 	unsigned portBASE_TYPE xHigherPriorityTaskWoken = pdFalse;
 864              		.loc 1 364 0
 865 0006 0023     		movs	r3, #0
 866 0008 7B60     		str	r3, [r7, #4]
 365:App/STM32F4-Discovery/spi.c **** 
 366:App/STM32F4-Discovery/spi.c ****   // Test if DMA Stream Transfer Complete interrupt
 367:App/STM32F4-Discovery/spi.c ****   if (DMA_GetITStatus (SPIx_TX_DMA_STREAM, SPIx_TX_DMA_FLAG_TCIF)) {
 867              		.loc 1 367 0
 868 000a 1B48     		ldr	r0, .L21
 869 000c 1B49     		ldr	r1, .L21+4
 870 000e FFF7FEFF 		bl	DMA_GetITStatus
 871 0012 0346     		mov	r3, r0
 872 0014 002B     		cmp	r3, #0
 873 0016 24D0     		beq	.L18
 368:App/STM32F4-Discovery/spi.c ****     
 369:App/STM32F4-Discovery/spi.c **** 	DMA_ClearITPendingBit (SPIx_TX_DMA_STREAM, SPIx_TX_DMA_FLAG_TCIF);
 874              		.loc 1 369 0
 875 0018 1748     		ldr	r0, .L21
 876 001a 1849     		ldr	r1, .L21+4
 877 001c FFF7FEFF 		bl	DMA_ClearITPendingBit
 370:App/STM32F4-Discovery/spi.c **** 
 371:App/STM32F4-Discovery/spi.c **** 	while (SPI_I2S_GetFlagStatus (SPIx, SPI_I2S_FLAG_BSY) == SET);
 878              		.loc 1 371 0
 879 0020 00BF     		nop
 880              	.L19:
 881              		.loc 1 371 0 is_stmt 0 discriminator 1
 882 0022 1748     		ldr	r0, .L21+8
 883 0024 8021     		movs	r1, #128
 884 0026 FFF7FEFF 		bl	SPI_I2S_GetFlagStatus
 885 002a 0346     		mov	r3, r0
 886 002c 012B     		cmp	r3, #1
 887 002e F8D0     		beq	.L19
 372:App/STM32F4-Discovery/spi.c ****     /*
 373:App/STM32F4-Discovery/spi.c ****      * The DMA stream is disabled in hardware at the end of the transfer
 374:App/STM32F4-Discovery/spi.c ****      * Now we can deselect the display. If more than one peripheral was being run
 375:App/STM32F4-Discovery/spi.c ****      * on this SPI peripheral, we would have to do both/all of them, or work out
 376:App/STM32F4-Discovery/spi.c ****      * which one was active and deselect that one.i
 377:App/STM32F4-Discovery/spi.c **** 	
 378:App/STM32F4-Discovery/spi.c ****      */
 379:App/STM32F4-Discovery/spi.c **** 	CSOFFx();
 888              		.loc 1 379 0 is_stmt 1
 889 0030 144B     		ldr	r3, .L21+12
 890 0032 144A     		ldr	r2, .L21+12
 891 0034 128B     		ldrh	r2, [r2, #24]	@ movhi
 892 0036 92B2     		uxth	r2, r2
 893 0038 42F01002 		orr	r2, r2, #16
 894 003c 92B2     		uxth	r2, r2
 895 003e 1A83     		strh	r2, [r3, #24]	@ movhi
 380:App/STM32F4-Discovery/spi.c **** 	DMA_Cmd(SPIx_RX_DMA_STREAM, DISABLE);		
 896              		.loc 1 380 0
 897 0040 1148     		ldr	r0, .L21+16
 898 0042 0021     		movs	r1, #0
 899 0044 FFF7FEFF 		bl	DMA_Cmd
 381:App/STM32F4-Discovery/spi.c ****        
 382:App/STM32F4-Discovery/spi.c **** 	taskENTER_CRITICAL(); 
 900              		.loc 1 382 0
 901 0048 FFF7FEFF 		bl	vPortEnterCritical
 383:App/STM32F4-Discovery/spi.c **** //	 xSemaphoreGive( xSemaphoreDMASPI );
 384:App/STM32F4-Discovery/spi.c **** 	xSemaphoreGiveFromISR( xSemaphoreDMASPIx, &xHigherPriorityTaskWoken );
 902              		.loc 1 384 0
 903 004c 0F4B     		ldr	r3, .L21+20
 904 004e 1A68     		ldr	r2, [r3]
 905 0050 3B1D     		adds	r3, r7, #4
 906 0052 1046     		mov	r0, r2
 907 0054 0021     		movs	r1, #0
 908 0056 1A46     		mov	r2, r3
 909 0058 0023     		movs	r3, #0
 910 005a FFF7FEFF 		bl	xQueueGenericSendFromISR
 385:App/STM32F4-Discovery/spi.c ****  	taskEXIT_CRITICAL();  
 911              		.loc 1 385 0
 912 005e FFF7FEFF 		bl	vPortExitCritical
 913              	.L18:
 386:App/STM32F4-Discovery/spi.c ****  }
 387:App/STM32F4-Discovery/spi.c ****    portEND_SWITCHING_ISR( xHigherPriorityTaskWoken );
 914              		.loc 1 387 0
 915 0062 7B68     		ldr	r3, [r7, #4]
 916 0064 002B     		cmp	r3, #0
 917 0066 03D0     		beq	.L17
 918              		.loc 1 387 0 is_stmt 0 discriminator 1
 919 0068 094B     		ldr	r3, .L21+24
 920 006a 4FF08052 		mov	r2, #268435456
 921 006e 1A60     		str	r2, [r3]
 922              	.L17:
 388:App/STM32F4-Discovery/spi.c **** }
 923              		.loc 1 388 0 is_stmt 1
 924 0070 0837     		adds	r7, r7, #8
 925 0072 BD46     		mov	sp, r7
 926              		@ sp needed
 927 0074 80BD     		pop	{r7, pc}
 928              	.L22:
 929 0076 00BF     		.align	2
 930              	.L21:
 931 0078 58640240 		.word	1073898584
 932 007c 00800018 		.word	402685952
 933 0080 00300140 		.word	1073819648
 934 0084 00000240 		.word	1073872896
 935 0088 40640240 		.word	1073898560
 936 008c 00000000 		.word	xSemaphoreDMASPIx
 937 0090 04ED00E0 		.word	-536810236
 938              		.cfi_endproc
 939              	.LFE113:
 941              		.section	.text.spi_dma_write_read,"ax",%progbits
 942              		.align	2
 943              		.global	spi_dma_write_read
 944              		.thumb
 945              		.thumb_func
 947              	spi_dma_write_read:
 948              	.LFB114:
 389:App/STM32F4-Discovery/spi.c **** 
 390:App/STM32F4-Discovery/spi.c **** 
 391:App/STM32F4-Discovery/spi.c **** /*---------------------------- Matic Knap 25 Jun 2014 ---------------------*/
 392:App/STM32F4-Discovery/spi.c **** 
 393:App/STM32F4-Discovery/spi.c **** void spi_dma_write_read(uint32_t spi, uint8_t *bufRX, uint8_t *bufTX, uint16_t lenRX,  uint16_t len
 394:App/STM32F4-Discovery/spi.c **** {
 949              		.loc 1 394 0
 950              		.cfi_startproc
 951              		@ args = 4, pretend = 0, frame = 16
 952              		@ frame_needed = 1, uses_anonymous_args = 0
 953 0000 80B5     		push	{r7, lr}
 954              	.LCFI12:
 955              		.cfi_def_cfa_offset 8
 956              		.cfi_offset 7, -8
 957              		.cfi_offset 14, -4
 958 0002 84B0     		sub	sp, sp, #16
 959              	.LCFI13:
 960              		.cfi_def_cfa_offset 24
 961 0004 00AF     		add	r7, sp, #0
 962              	.LCFI14:
 963              		.cfi_def_cfa_register 7
 964 0006 F860     		str	r0, [r7, #12]
 965 0008 B960     		str	r1, [r7, #8]
 966 000a 7A60     		str	r2, [r7, #4]
 967 000c 7B80     		strh	r3, [r7, #2]	@ movhi
 395:App/STM32F4-Discovery/spi.c **** 		
 396:App/STM32F4-Discovery/spi.c **** 		/*! spi_dma_read it has to be used with \n
 397:App/STM32F4-Discovery/spi.c **** 		 * memcpy from bufferRX right after it has recieve \n
 398:App/STM32F4-Discovery/spi.c **** 		 * data on SPI. */
 399:App/STM32F4-Discovery/spi.c **** 	if (spi == SPIy)
 968              		.loc 1 399 0
 969 000e FA68     		ldr	r2, [r7, #12]
 970 0010 254B     		ldr	r3, .L26
 971 0012 9A42     		cmp	r2, r3
 972 0014 22D1     		bne	.L24
 973              	.LBB2:
 400:App/STM32F4-Discovery/spi.c **** 	{
 401:App/STM32F4-Discovery/spi.c **** 		DMA_SetCurrDataCounter(SPIy_RX_DMA_STREAM, lenRX);
 974              		.loc 1 401 0
 975 0016 7B88     		ldrh	r3, [r7, #2]
 976 0018 2448     		ldr	r0, .L26+4
 977 001a 1946     		mov	r1, r3
 978 001c FFF7FEFF 		bl	DMA_SetCurrDataCounter
 402:App/STM32F4-Discovery/spi.c **** 		DMA_SetCurrDataCounter(SPIy_TX_DMA_STREAM, lenTX);
 979              		.loc 1 402 0
 980 0020 3B8B     		ldrh	r3, [r7, #24]
 981 0022 2348     		ldr	r0, .L26+8
 982 0024 1946     		mov	r1, r3
 983 0026 FFF7FEFF 		bl	DMA_SetCurrDataCounter
 403:App/STM32F4-Discovery/spi.c **** 		SPIy_TX_DMA_STREAM->M0AR =(uint32_t)bufTX;	
 984              		.loc 1 403 0
 985 002a 214B     		ldr	r3, .L26+8
 986 002c 7A68     		ldr	r2, [r7, #4]
 987 002e DA60     		str	r2, [r3, #12]
 404:App/STM32F4-Discovery/spi.c **** 		SPIy_RX_DMA_STREAM->M0AR =(uint32_t)bufRX;	
 988              		.loc 1 404 0
 989 0030 1E4B     		ldr	r3, .L26+4
 990 0032 BA68     		ldr	r2, [r7, #8]
 991 0034 DA60     		str	r2, [r3, #12]
 405:App/STM32F4-Discovery/spi.c **** 
 406:App/STM32F4-Discovery/spi.c **** 		CSON2(); // chip select 
 992              		.loc 1 406 0
 993 0036 FFF7FEFF 		bl	CSON2
 407:App/STM32F4-Discovery/spi.c **** 		DMA_Cmd(SPIy_TX_DMA_STREAM, ENABLE);		
 994              		.loc 1 407 0
 995 003a 1D48     		ldr	r0, .L26+8
 996 003c 0121     		movs	r1, #1
 997 003e FFF7FEFF 		bl	DMA_Cmd
 408:App/STM32F4-Discovery/spi.c **** 		DMA_Cmd(SPIy_RX_DMA_STREAM, ENABLE);
 998              		.loc 1 408 0
 999 0042 1A48     		ldr	r0, .L26+4
 1000 0044 0121     		movs	r1, #1
 1001 0046 FFF7FEFF 		bl	DMA_Cmd
 409:App/STM32F4-Discovery/spi.c **** 		/* Block until the semaphore is given */
 410:App/STM32F4-Discovery/spi.c ****         	xSemaphoreTake(xSemaphoreDMASPIy, 10/portTICK_RATE_MS);	
 1002              		.loc 1 410 0
 1003 004a 1A4B     		ldr	r3, .L26+12
 1004 004c 1B68     		ldr	r3, [r3]
 1005 004e 1846     		mov	r0, r3
 1006 0050 0021     		movs	r1, #0
 1007 0052 0A22     		movs	r2, #10
 1008 0054 0023     		movs	r3, #0
 1009 0056 FFF7FEFF 		bl	xQueueGenericReceive
 1010              	.LBE2:
 1011 005a 21E0     		b	.L23
 1012              	.L24:
 1013              	.LBB3:
 411:App/STM32F4-Discovery/spi.c **** 		//CSOFF(); // chip deselect		
 412:App/STM32F4-Discovery/spi.c **** 	}
 413:App/STM32F4-Discovery/spi.c **** 	else
 414:App/STM32F4-Discovery/spi.c **** 	{
 415:App/STM32F4-Discovery/spi.c **** 		DMA_SetCurrDataCounter(SPIx_RX_DMA_STREAM, lenRX);
 1014              		.loc 1 415 0
 1015 005c 7B88     		ldrh	r3, [r7, #2]
 1016 005e 1348     		ldr	r0, .L26+4
 1017 0060 1946     		mov	r1, r3
 1018 0062 FFF7FEFF 		bl	DMA_SetCurrDataCounter
 416:App/STM32F4-Discovery/spi.c **** 		DMA_SetCurrDataCounter(SPIx_TX_DMA_STREAM, lenTX);
 1019              		.loc 1 416 0
 1020 0066 3B8B     		ldrh	r3, [r7, #24]
 1021 0068 1148     		ldr	r0, .L26+8
 1022 006a 1946     		mov	r1, r3
 1023 006c FFF7FEFF 		bl	DMA_SetCurrDataCounter
 417:App/STM32F4-Discovery/spi.c **** 		SPIx_TX_DMA_STREAM->M0AR =(uint32_t)bufTX;	
 1024              		.loc 1 417 0
 1025 0070 0F4B     		ldr	r3, .L26+8
 1026 0072 7A68     		ldr	r2, [r7, #4]
 1027 0074 DA60     		str	r2, [r3, #12]
 418:App/STM32F4-Discovery/spi.c **** 		SPIx_RX_DMA_STREAM->M0AR =(uint32_t)bufRX;	
 1028              		.loc 1 418 0
 1029 0076 0D4B     		ldr	r3, .L26+4
 1030 0078 BA68     		ldr	r2, [r7, #8]
 1031 007a DA60     		str	r2, [r3, #12]
 419:App/STM32F4-Discovery/spi.c **** 
 420:App/STM32F4-Discovery/spi.c **** 		CSON1(); // chip select 
 1032              		.loc 1 420 0
 1033 007c FFF7FEFF 		bl	CSON1
 421:App/STM32F4-Discovery/spi.c **** 		DMA_Cmd(SPIx_TX_DMA_STREAM, ENABLE);		
 1034              		.loc 1 421 0
 1035 0080 0B48     		ldr	r0, .L26+8
 1036 0082 0121     		movs	r1, #1
 1037 0084 FFF7FEFF 		bl	DMA_Cmd
 422:App/STM32F4-Discovery/spi.c **** 		DMA_Cmd(SPIx_RX_DMA_STREAM, ENABLE);
 1038              		.loc 1 422 0
 1039 0088 0848     		ldr	r0, .L26+4
 1040 008a 0121     		movs	r1, #1
 1041 008c FFF7FEFF 		bl	DMA_Cmd
 423:App/STM32F4-Discovery/spi.c **** 		/* Block until the semaphore is given */
 424:App/STM32F4-Discovery/spi.c ****         	xSemaphoreTake(xSemaphoreDMASPIx, 10/portTICK_RATE_MS);	
 1042              		.loc 1 424 0
 1043 0090 094B     		ldr	r3, .L26+16
 1044 0092 1B68     		ldr	r3, [r3]
 1045 0094 1846     		mov	r0, r3
 1046 0096 0021     		movs	r1, #0
 1047 0098 0A22     		movs	r2, #10
 1048 009a 0023     		movs	r3, #0
 1049 009c FFF7FEFF 		bl	xQueueGenericReceive
 1050              	.L23:
 1051              	.LBE3:
 425:App/STM32F4-Discovery/spi.c **** 		//CSOFF(); // chip deselect	
 426:App/STM32F4-Discovery/spi.c **** 	}
 427:App/STM32F4-Discovery/spi.c **** 
 428:App/STM32F4-Discovery/spi.c **** 
 429:App/STM32F4-Discovery/spi.c **** 
 430:App/STM32F4-Discovery/spi.c **** }	
 1052              		.loc 1 430 0
 1053 00a0 1037     		adds	r7, r7, #16
 1054 00a2 BD46     		mov	sp, r7
 1055              		@ sp needed
 1056 00a4 80BD     		pop	{r7, pc}
 1057              	.L27:
 1058 00a6 00BF     		.align	2
 1059              	.L26:
 1060 00a8 00300140 		.word	1073819648
 1061 00ac 40640240 		.word	1073898560
 1062 00b0 58640240 		.word	1073898584
 1063 00b4 00000000 		.word	xSemaphoreDMASPIy
 1064 00b8 00000000 		.word	xSemaphoreDMASPIx
 1065              		.cfi_endproc
 1066              	.LFE114:
 1068              		.text
 1069              	.Letext0:
 1070              		.file 2 "/Users/maticknap/ARM/gcc-arm-none-eabi-4_8-2014q2/arm-none-eabi/include/machine/_default_
 1071              		.file 3 "/Users/maticknap/ARM/gcc-arm-none-eabi-4_8-2014q2/arm-none-eabi/include/stdint.h"
 1072              		.file 4 "App/STM32F4-Discovery/Libraries/CMSIS/ST/STM32F4xx/Include/stm32f4xx.h"
 1073              		.file 5 "App/STM32F4-Discovery/Libraries/STM32F4xx_StdPeriph_Driver/inc/stm32f4xx_dma.h"
 1074              		.file 6 "App/STM32F4-Discovery/Libraries/STM32F4xx_StdPeriph_Driver/inc/stm32f4xx_gpio.h"
 1075              		.file 7 "App/STM32F4-Discovery/Libraries/STM32F4xx_StdPeriph_Driver/inc/stm32f4xx_spi.h"
 1076              		.file 8 "App/STM32F4-Discovery/Libraries/STM32F4xx_StdPeriph_Driver/inc/misc.h"
 1077              		.file 9 "Source/portable/GCC/ARM_CM4F/portmacro.h"
 1078              		.file 10 "Source/include/queue.h"
 1079              		.file 11 "Source/include/semphr.h"
 1080              		.file 12 "App/STM32F4-Discovery/Libraries/CMSIS/Include/core_cm4.h"
 1081              		.file 13 "App/STM32F4-Discovery/spi.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 spi.c
                            *COM*:00000000000007d0 bufferTX
                            *COM*:00000000000007d0 bufferRX
                            *COM*:0000000000000004 bufferRXidx
                            *COM*:0000000000000004 bufferTXidx
                            *COM*:0000000000000004 dat_lengthRX
                            *COM*:0000000000000004 dat_lengthTX
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:26     .bss.xSemaphoreDMASPIx:0000000000000000 $d
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:29     .bss.xSemaphoreDMASPIx:0000000000000000 xSemaphoreDMASPIx
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:32     .bss.xSemaphoreDMASPIy:0000000000000000 $d
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:35     .bss.xSemaphoreDMASPIy:0000000000000000 xSemaphoreDMASPIy
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:38     .text.init_SPIx:0000000000000000 $t
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:43     .text.init_SPIx:0000000000000000 init_SPIx
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:379    .text.init_SPIx:000000000000025c $d
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:391    .text.init_SPIy:0000000000000000 $t
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:396    .text.init_SPIy:0000000000000000 init_SPIy
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:731    .text.init_SPIy:000000000000025c $d
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:743    .text.DMA2_Stream2_IRQHandler:0000000000000000 $t
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:748    .text.DMA2_Stream2_IRQHandler:0000000000000000 DMA2_Stream2_IRQHandler
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:832    .text.DMA2_Stream2_IRQHandler:0000000000000078 $d
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:842    .text.DMA2_Stream3_IRQHandler:0000000000000000 $t
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:847    .text.DMA2_Stream3_IRQHandler:0000000000000000 DMA2_Stream3_IRQHandler
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:931    .text.DMA2_Stream3_IRQHandler:0000000000000078 $d
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:942    .text.spi_dma_write_read:0000000000000000 $t
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:947    .text.spi_dma_write_read:0000000000000000 spi_dma_write_read
/var/folders/hq/s45830mn6w17j2ybbkgkrjk00000gn/T//cchPglUn.s:1060   .text.spi_dma_write_read:00000000000000a8 $d
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
RCC_AHB1PeriphClockCmd
GPIO_Init
GPIO_PinAFConfig
RCC_APB2PeriphClockCmd
SPI_Init
SPI_Cmd
DMA_DeInit
DMA_GetCmdStatus
DMA_StructInit
DMA_Init
DMA_ITConfig
SPI_I2S_ClearFlag
NVIC_Init
SPI_I2S_DMACmd
xQueueGenericCreate
DMA_GetITStatus
DMA_ClearITPendingBit
SPI_I2S_GetFlagStatus
DMA_Cmd
vPortEnterCritical
xQueueGenericSendFromISR
vPortExitCritical
DMA_SetCurrDataCounter
CSON2
xQueueGenericReceive
CSON1
